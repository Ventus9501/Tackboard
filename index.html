<style>
body {
    font-family: 'Arial', sans-serif;
    margin: 0;
    padding: 0;
    background: #f5e55a;
    display: flex;
    justify-content: flex-start;
    align-items: flex-start;
    height: 100vh;
    grid-template-rows: 1fr auto;
    color: black;
}

html, body {
    height: 100%;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
}

.container {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    flex: 1;
    display: flex;
    flex-direction: column;
}

.welcome_container {
    position: static;
    margin-left: 10px;
    margin-top: 10px;
    background: linear-gradient(#292929, #141414);
    z-index: 1;
    border-radius: 1rem;
    display: flex;
    align-items: center;
    padding: 2vw;
    height: 50px; 
    justify-content: space-between;
}

.welcome_message {
    font-family: 'Verdana', sans-serif;
    color: #ffffff;
    margin-left: 2vw;
    flex-grow: 1; 
    font-size: auto;
}

.buttons {
    display: flex;
    justify-content: space-between; 
    align-items: center;
    margin: 1rem;
    margin-bottom:1.2rem ;
}

.buttons button {
    background: linear-gradient(#242424, #1a1a1a); 
    color: rgb(255, 255, 255);
    padding: 1rem; 
    border: none;
    border-radius: 0.5rem;
    cursor: pointer;
    width: auto;
    font-size: 1.2rem;
    transition: background-color 0.3s ease;
    max-width: 150px;
    display: flex; 
    justify-content: center; 
    align-items: center; 
    height: 50px; 
}


.buttons button:hover {
    color: rgb(255, 255, 255);
    box-shadow: 10px 10px 10px rgba(0, 0, 0, 0.2);
    transform: translateY(-5px);
    transition: box-shadow 0.3s ease, transform 0.3s ease;
}

.listings {
    background-color: #212121;
    padding: 2vw;
    border-radius: 1rem;
    box-shadow: 0 0 1vw rgba(255, 255, 255, 0.2);
    width: 100%;
    display: flex;
    flex-wrap: wrap;
    justify-content: flex-start;
    align-items: flex-start;
    flex-grow: 1;
    min-height: 300px; 
    margin-top: 2vh;
}

.listings_message {
    width: 100%;
    text-align: center;
    margin-bottom: 2vh;
    font-size: 1.5rem;
    font-weight: bold;
    color: white;
    display: block;
    position: relative;
}

.no_listings {
    color: white;
    font-size: 5vw;
    text-align: center;
    margin: auto;
    margin-bottom: 20vh;
    font-weight: bold;
}

.job-item {
    background-color: rgba(255, 255, 255, 0.9);
    padding: 2vw;
    margin: 2vw;
    width: calc(25% - 4vw);
    box-sizing: border-box;
    box-shadow: 0 0 4vw rgba(0, 0, 0, 0.2);
    border-radius: 1rem;
    flex-grow: 1;
    min-width: 12rem;
    max-width: 20rem;
    min-height: 200px;
}

.job-item:last-child {
    border-bottom: none;
    border-right: none;
}

.logo {
    width: 6vw;
    height: 12vh;
    border-radius: 50px;
    margin-bottom: 20px;
}

.job-item strong {
    display: block;
    font-size: 1.8rem;
    margin-bottom: 1vw;
}

.job-item p {
    margin: 1vw 0;
}

.delete-btn {
    background-color: #d9534f; 
    color: white; 
    padding: 0.5rem 1rem; 
    border: none;
    border-radius: 0.5rem;
    cursor: pointer;
    font-size: 1.2rem;
    transition: background-color 0.3s ease;
    margin-top: 1rem;
    display: inline-block; 
}

.delete-btn:hover {
    background-color: #c9302c; 
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
    
    transition:background-color 0.2s ease, box-shadow 0.2s ease;
}


.footer {
    background-color: rgba(0, 0, 0, 0.8);
    color: white;
    text-align: center;
    max-width: 100vw; 
    width: 100%;
    padding: 2vh 0;
    position: relative;
    bottom: 0;
    left: 0;
    margin: 2vh auto;
    margin-bottom: 0;
    font-size: 1.2rem;
    height: 50px; 
}

.welcome_container, .listings {
    margin-left: 1vw;
    width: 94vw;
}

@media (max-width: 768px) {
    .welcome_message {
        font-size: 1rem; /* Smaller font size for welcome message */
    }

    .buttons button {
        font-size: 1rem; /* Smaller font size for buttons */
        padding: 0.8rem; /* Adjust padding for smaller screens */
    }

    .listings_message {
        font-size: 1.2rem; /* Smaller font size for listings message */
    }

    .job-item strong {
        font-size: 1.4rem; /* Smaller font size for job titles */
    }

    .footer {
        font-size: 1rem; /* Smaller font size for footer */
    }
}

@media (max-width: 480px) {
    .welcome_message {
        font-size: 1rem; /* Even smaller font size for very small screens */
    }

    .logo {
        width: 3vw;
        height: 6vh;
    }    
    
    .buttons button {
        font-size: 0.9rem; /* Smaller font size for buttons on mobile */
        padding: 0.7rem; /* Adjust padding for mobile */
    }

    .listings_message {
        font-size: 1rem; /* Smaller font size for listings message */
    }

    .job-item strong {
        font-size: 1.2rem; /* Smaller font size for job titles */
    }

    .footer {
        font-size: 0.9rem; /* Smaller font size for footer on mobile */
    }
}

</style>
<title>Student Job Search</title>

<body>
    <div class="container">
        <div class="welcome_container">
            <div>
                <img class = "logo" id = "logo": src="logo.png" alt="logo">
            </div>
            <div class="welcome_message">
                <h1 id="welcome"></h1>
            </div>
            <!-- Buttons inside welcome_container -->
            <div class="buttons">
                <div class="inbox" id="inboxContainer" style="display: none;">
                    <button id="inbox">Inbox</button>
                </div>
                <div class="add_job" id="add_job_container" style="display: none;">
                    <button id="add_job">Add Job</button>
                </div>
                <div class="message_button">
                    <button id="messages" onclick="location.href='messages.html'">Messages</button>
                </div>
                <button id="sign_out">Sign Out</button>
            </div>
        </div>

        <div id="listings" class="listings">
            <div class="listings_message">
                <h2>Job Listings</h2>
            </div>
        </div>
    </div>
    <div class="footer">
        <p>Contact us: Tack_Support@gmail.com | Phone: (636)-399-8767</p>
    </div>
</body>

<script>
    let listings = [];

    document.getElementById('sign_out').addEventListener('click', function() {
        if (confirm("Would you like to sign out?")) {
            // Remove the current user from local storage
            localStorage.removeItem('currentUser');
            // Redirect the user to the login page
            window.location.href = 'login.html';
        }
    });

    document.getElementById('inbox').addEventListener('click', function() {
        window.location.href = 'inbox.html';
    });

    document.getElementById('add_job').addEventListener('click', function() {
        window.location.href = 'employer_form.html';
    });

    window.onload = function() {
        // Check if the user is logged in
        let currentUser = localStorage.getItem('currentUser');
        if (currentUser === null) {
            window.location.href = 'login.html';
        } else {
            // Display the user's name
            document.getElementById('welcome').innerText = 'Welcome to Tack Board, ' + currentUser + '!';
            
            // Check if the current user is an admin and display the inbox button if they are
            let users = JSON.parse(localStorage.getItem('users')) || [];
            let currentUserData = users.find(user => user.name === currentUser);
            if (currentUserData && currentUserData.role === 'Admin') {
                document.getElementById('inboxContainer').style.display = 'block';
                inboxUpdate(); // Update inbox count
            }

            // Check if the current user is an Employer or Admin and display the Add Job button if they are
            if (currentUserData && (currentUserData.role === 'Admin' || currentUserData.role === 'Employer')) {
                document.getElementById('add_job_container').style.display = 'block';
            }

            // Load the job listings
            loadListings(currentUserData);
            // Update message button
            messageUpdate(currentUserData);
        }
    }

    function loadListings(currentUserData) {
    let jobListings = JSON.parse(localStorage.getItem('jobListings')) || [];
    const listingsContainer = document.getElementById('listings');

    // Clear listings but keep header
    listingsContainer.innerHTML = `
        <div class="listings_message">
            <h2>Job Listings</h2>
        </div>
    `;

    if (jobListings.length > 0) {
        jobListings.forEach((job, index) => {
            const jobItem = document.createElement('div');
            jobItem.className = 'job-item';
            jobItem.innerHTML = `
                <strong>Title:</strong> ${job.jobTitle}<br>
                <p><strong>Description:</strong> ${job.jobDescription}</p>
                <p><strong>Location:</strong> ${job.jobLocation}</p>
                <p><strong>Compensation:</strong> ${job.jobSalary}</p>
                <p><strong>Email:</strong> ${job.contactEmail}</p>
                <p><strong>Phone:</strong> ${job.contactPhone}</p>
                <p><strong>Employer:</strong> ${job.employerName}</p>
                <button class="delete-btn" onclick="deleteJob(${index})" style="display: none;">Delete</button>
            `;
            listingsContainer.appendChild(jobItem);
        });
    } else {
        const noJobsMessage = document.createElement('p');
        noJobsMessage.className = 'no_listings';
        noJobsMessage.innerText = 'No job listings available.';
        listingsContainer.appendChild(noJobsMessage);
    }

    // Show delete buttons for Admin and the original job poster
    if (currentUserData && (currentUserData.role === 'Admin' || currentUserData.role === 'Employer')) {
        jobListings.forEach((job, index) => {
            const deleteButton = listingsContainer.querySelectorAll('.delete-btn')[index];
            if (currentUserData.role === 'Admin' || job.employerName === currentUserData.name) {
                deleteButton.style.display = 'inline-block'; // Show delete button
            }
        });
    }
}



    function deleteJob(index) {
        if (confirm("Are you sure you want to delete this job listing?")) {
            let jobListings = JSON.parse(localStorage.getItem('jobListings')) || [];
            jobListings.splice(index, 1);
            localStorage.setItem('jobListings', JSON.stringify(jobListings));
            location.reload();
        }
    }

    function inboxUpdate() {
        let pendingJobListings = JSON.parse(localStorage.getItem('pendingJobListings')) || [];
        if (pendingJobListings.length > 0) {
            document.getElementById('inbox').innerText = `Inbox (${pendingJobListings.length})`;
        } else {
            document.getElementById('inbox').innerText = 'Inbox';
        }
    }

    function messageUpdate(currentUserData) {
        let messages = JSON.parse(localStorage.getItem('messages')) || {};
        let userMessages = messages[currentUserData.email] || [];
        if (userMessages.length > 0) {
            document.getElementById('messages').innerText = `Messages (${userMessages.length})`;
        } else {
            document.getElementById('messages').innerText = 'Messages';
        }
    }
</script>
